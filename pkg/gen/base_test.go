package gen_test

import (
	"testing"

	"github.com/redcarbon-dev/nats-proto-pubgen/pkg/gen"
	"github.com/stretchr/testify/assert"

	_ "embed"
)

func TestRenderBase(t *testing.T) {
	expected := "// Code generated by pubgen. DO NOT EDIT.\n\npackage pubgen\n\ntype Publisher interface {\n\tPublish(topic string, msg []byte) error\n}\n\ntype PubCli struct {\n\tp Publisher\n}\n\nfunc (p *PubCli) publish(topic string, msg []byte) error {\n\treturn p.p.Publish(topic, msg)\n}\n\nfunc NewPublisher(p Publisher) *PubCli {\n\treturn &PubCli{\n\t\tp: p,\n\t}\n}\n"
	res, err := gen.RenderBaseFile()
	assert.Nil(t, err)
	assert.Equal(t, expected, res)
}
